# -*- coding: utf-8 -*-
from __future__ import unicode_literals, print_function, absolute_import
from .infr_social import inf_object
from arcpy import Parameter,AddField_management,AddJoin_management,CalculateField_management,RemoveJoin_management,SelectLayerByAttribute_management,FieldMappings,Merge_management,DeleteField_management,TableToTable_conversion
from arcpy.mapping import Layer,RemoveLayer,AddLayer
from os.path import join
from os import getcwd, chdir, listdir
from .utils import mkd
from shutil import copy

__all__ = ["licon"]

class licon(inf_object):
	@property
	def pms_ad(self):
		pm5 = Parameter('cat_leche',u'Cat\xe1logo de lecher√≠as nacional (ShapeFile)',"Input",'GPFeatureLayer',"Required")
		return [pm5]

	def copy_shp(self,parameters):
		chdir('..')
		direct = u'LecheriasNacional{0}'.format(self.fch.strftime('%m%y'))
		mkd(direct)
		root = Layer(parameters[0].valueAsText).workspacePath
		for arch in listdir(root):
			if arch in ['{0}.{1}'.format(parameters[0].valueAsText,ext) for ext in ['dbf','prj','shp','shx']]:
				copy(join(root,arch),join(direct,arch))
		chdir('FINAL')

	def set_shp(self,parameters):
		flm = FieldMappings()
		flm.loadFromString(u'CVE_LECHE "CVE_LECHE" true true false 10 Text 0 0 ,First,#,{0},CVE_LECHE,-1,-1;CVE_ENT "CVE_ENT" true true false 2 Text 0 0 ,First,#,{0},CVE_EDO,-1,-1;CVE_MUNC "CVE_MUNC" true true false 5 Text 0 0 ,First,#,{0},CVE_MUN,-1,-1;CVE_LOCC "CVE_LOCC" true true false 9 Text 0 0 ,First,#,{0},CVE_LOC,-1,-1;NOM_ENT "NOM_ENT" true true false 110 Text 0 0 ,First,#,{0},NOM_EDO,-1,-1;ABRE_ENT "ABRE_ENT" true true false 16 Text 0 0 ,First,#,{0},ABRE_EDO,-1,-1;NOM_MUN "NOM_MUN" true true false 110 Text 0 0 ,First,#,{0},NOM_MUN,-1,-1;NOM_LOC "NOM_LOC" true true false 110 Text 0 0 ,First,#,{0},NOM_LOC,-1,-1;LOCURB "LOCURB" true true false 2 Text 0 0 ,First,#,{0},LOCURB,-1,-1;PAS "PAS" true true false 30 Text 0 0 ,First,#,{0},PAS,-1,-1;CALLE "CALLE" true true false 40 Text 0 0 ,First,#,{0},CALLE,-1,-1;COLONIA "COLONIA" true true false 40 Text 0 0 ,First,#,{0},COLONIA,-1,-1;REFNCIA "REFNCIA" true true false 60 Text 0 0 ,First,#,{0},REFNCIA,-1,-1;FAMILIAS "FAMILIAS" true true false 5 Long 0 5 ,First,#,{0},FAMILIAS,-1,-1;BENEFICIAR "BENEFICIAR" true true false 6 Long 0 6 ,First,#,{0},BENEFICIAR,-1,-1;NIN0A12 "NIN0A12" true true false 6 Long 0 6 ,First,#,{0},NIN0A12,-1,-1;GESTLAC "GESTLAC" true true false 6 Long 0 6 ,First,#,{0},GESTLAC,-1,-1;ENFCRODIS "ENFCRODIS" true true false 6 Long 0 6 ,First,#,{0},ENFCRODIS,-1,-1;ADUL60_ "ADUL60_" true true false 6 Long 0 6 ,First,#,{0},ADUL60_,-1,-1;MUJ13A15 "MUJ13A15" true true false 5 Long 0 5 ,First,#,{0},MUJ13A15,-1,-1;MUJ45A59 "MUJ45A59" true true false 5 Long 0 5 ,First,#,{0},MUJ45A59,-1,-1;ML_TVENTA "ML_TVENTA" true true false 1 Short 0 1 ,First,#,{0},ML_TVENTA,-1,-1;INIOPER "INIOPER" true true false 8 Date 0 0 ,First,#,{0},INIOPER,-1,-1;LECHE "LECHE" true true false 7 Text 0 0 ,First,#,{0},LECHE,-1,-1;NCONTR "NCONTR" true true false 1 Short 0 1 ,First,#,{0},NCONTR,-1,-1;CONTRATO "CONTRATO" true true false 15 Text 0 0 ,First,#,{0},CONTRATO,-1,-1;NLOCA "NLOCA" true true false 2 Short 0 2 ,First,#,{0},NLOCA,-1,-1;LOCAL "LOCAL" true true false 20 Text 0 0 ,First,#,{0},LOCAL,-1,-1;TURNO "TURNO" true true false 10 Text 0 0 ,First,#,{0},TURNO,-1,-1;TMATINI "TMATINI" true true false 5 Text 0 0 ,First,#,{0},TMATINI,-1,-1;TMATFIN "TMATFIN" true true false 5 Text 0 0 ,First,#,{0},TMATFIN,-1,-1;TVESINI "TVESINI" true true false 5 Text 0 0 ,First,#,{0},TVESINI,-1,-1;TVESFIN "TVESFIN" true true false 5 Text 0 0 ,First,#,{0},TVESFIN,-1,-1;LITROS "LITROS" true true false 6 Long 0 6 ,First,#,{0},LITROS,-1,-1;ML_TLECH "ML_TLECH" true true false 1 Short 0 1 ,First,#,{0},ML_TLECH,-1,-1;TIPO "TIPO" true true false 10 Text 0 0 ,First,#,{0},TIPO,-1,-1;HABITANTES "HABITANTES" true true false 9 Long 0 9 ,First,#,{0},HABITANTES,-1,-1;MUJERES "MUJERES" true true false 11 Double 0 11 ,First,#,{0},MUJERES,-1,-1;HOMBRES "HOMBRES" true true false 7 Long 0 7 ,First,#,{0},HOMBRES,-1,-1;AGEB "AGEB" true true false 5 Text 0 0 ,First,#,{0},AGEB,-1,-1;CPOSTAL "CPOSTAL" true true false 5 Long 0 5 ,First,#,{0},CPOSTAL,-1,-1;PROMOTOR "PROMOTOR" true true false 40 Text 0 0 ,First,#,{0},PROMOTOR,-1,-1;SUPERVISO "SUPERVISO" true true false 40 Text 0 0 ,First,#,{0},SUPERVISO,-1,-1;CONCESIO "CONCESIO" true true false 40 Text 0 0 ,First,#,{0},CONCESIO,-1,-1;DNRUTA "DNRUTA" true true false 6 Text 0 0 ,First,#,{0},DNRUTA,-1,-1;DSECUENCIA "DSECUENCIA" true true false 2 Short 0 2 ,First,#,{0},DSECUENCIA,-1,-1;DKMS "DKMS" true true false 19 Double 2 18 ,First,#,{0},DKMS,-1,-1;DTIEMPO "DTIEMPO" true true false 5 Long 0 5 ,First,#,{0},DTIEMPO,-1,-1;DSUBSIDIA "DSUBSIDIA" true true false 7 Long 0 7 ,First,#,{0},DSUBSIDIA,-1,-1;DFRISIA "DFRISIA" true true false 7 Long 0 7 ,First,#,{0},DFRISIA,-1,-1;DINSTITU "DINSTITU" true true false 7 Long 0 7 ,First,#,{0},DINSTITU,-1,-1;DSEMIDES "DSEMIDES" true true false 7 Long 0 7 ,First,#,{0},DSEMIDES,-1,-1;DFRESA "DFRESA" true true false 7 Long 0 7 ,First,#,{0},DFRESA,-1,-1;DVAINILLA "DVAINILLA" true true false 7 Long 0 7 ,First,#,{0},DVAINILLA,-1,-1;DCHOCOLATE "DCHOCOLATE" true true false 7 Long 0 7 ,First,#,{0},DCHOCOLATE,-1,-1;LTSBENMES "LTSBENMES" true true false 19 Double 2 18 ,First,#,{0},LTSBENMES,-1,-1'.format(parameters[0].valueAsText))
		Merge_management(parameters[0].valueAsText,'lecheriasnacional{0}.shp'.format(self.fch.strftime('%m%y')),flm)
		self.lyer = Layer('lecheriasnacional{0}.shp'.format(self.fch.strftime('%m%y')))
		licon.mapping_file(self,self.lyer)
		RemoveLayer(self.mxd.activeDataFrame,Layer(parameters[0].valueAsText))
		AddField_management(self.lyer,*[u"CVE_ACT","TEXT",0,0,9])
		return self.lyer

	def update_shp(self,parameters):
		cenf = Layer(parameters[3].valueAsText)
		SelectLayerByAttribute_management(self.lyer,"NEW_SELECTION",""" "CVE_LOCC" <> "CVE_ACT" """)
		AddJoin_management(self.lyer,u"CVE_ACT",cenf.name,u"CVE_LOCC","KEEP_COMMON")
		CalculateField_management(self.lyer,"{0}.CVE_LOCC".format(self.lyer.name),"!{0}.CVE_LOCC!".format(cenf.name),"PYTHON")
		CalculateField_management(self.lyer,"{0}.NOM_ENT".format(self.lyer.name),"!{0}.NOM_ENT!".format(cenf.name),"PYTHON")
		CalculateField_management(self.lyer,"{0}.ABRE_ENT".format(self.lyer.name),"!{0}.ABR_ENT!".format(cenf.name),"PYTHON")
		CalculateField_management(self.lyer,"{0}.NOM_MUN".format(self.lyer.name),"!{0}.NOM_MUN!".format(cenf.name),"PYTHON")
		CalculateField_management(self.lyer,"{0}.NOM_LOC".format(self.lyer.name),"!{0}.NOM_LOC!".format(cenf.name),"PYTHON")
		RemoveJoin_management(self.lyer)
		SelectLayerByAttribute_management(self.lyer,"CLEAR_SELECTION")
		DeleteField_management(self.lyer,u"CVE_ACT")
		RemoveLayer(self.mxd.activeDataFrame,Layer(cenf.name))

	def carto2010(self):
		flm = FieldMappings()
		flm.loadFromString(u'CVE_LECHE "CVE_LECHE" true true false 10 Text 0 0 ,First,#,{0},CVE_LECHE,-1,-1;CVE_ENT "CVE_ENT" true true false 2 Text 0 0 ,First,#,{0},CVE_ENT,-1,-1;CVE_MUNC "CVE_MUNC" true true false 5 Text 0 0 ,First,#,{0},CVE_MUNC,-1,-1;CVE_LOCC "CVE_LOCC" true true false 9 Text 0 0 ,First,#,{0},CVE_LOCC,-1,-1'.format(self.lyer.name))
		Merge_management(self.lyer,join(u'CARTO2010','n_lecherias2010_133_final_{0}.shp'.format(self.fch.strftime('%b%y'))),flm)
		flm.removeAll()
		flm.loadFromString(u'CVE_LECHE "CVE_LECHE" true true false 10 Text 0 0 ,First,#,{0},CVE_LECHE,-1,-1;CVE_LOCC "CVE_LOCC" true true false 9 Text 0 0 ,First,#,{0},CVE_LOCC,-1,-1;LOCURB "LOCURB" true true false 2 Text 0 0 ,First,#,{0},LOCURB,-1,-1;PAS "PAS" true true false 30 Text 0 0 ,First,#,{0},PAS,-1,-1;CALLE "CALLE" true true false 40 Text 0 0 ,First,#,{0},CALLE,-1,-1;COLONIA "COLONIA" true true false 40 Text 0 0 ,First,#,{0},COLONIA,-1,-1;REFNCIA "REFNCIA" true true false 60 Text 0 0 ,First,#,{0},REFNCIA,-1,-1;FAMILIAS "FAMILIAS" true true false 5 Long 0 5 ,First,#,{0},FAMILIAS,-1,-1;BENEFICIAR "BENEFICIAR" true true false 6 Long 0 6 ,First,#,{0},BENEFICIAR,-1,-1;NIN0A12 "NIN0A12" true true false 6 Long 0 6 ,First,#,{0},NIN0A12,-1,-1;GESTLAC "GESTLAC" true true false 6 Long 0 6 ,First,#,{0},GESTLAC,-1,-1;ENFCRODIS "ENFCRODIS" true true false 6 Long 0 6 ,First,#,{0},ENFCRODIS,-1,-1;ADUL60_ "ADUL60_" true true false 6 Long 0 6 ,First,#,{0},ADUL60_,-1,-1;MUJ13A15 "MUJ13A15" true true false 5 Long 0 5 ,First,#,{0},MUJ13A15,-1,-1;MUJ45A59 "MUJ45A59" true true false 5 Long 0 5 ,First,#,{0},MUJ45A59,-1,-1;ML_TVENTA "ML_TVENTA" true true false 1 Short 0 1 ,First,#,{0},ML_TVENTA,-1,-1;INIOPER "INIOPER" true true false 8 Date 0 0 ,First,#,{0},INIOPER,-1,-1;LECHE "LECHE" true true false 7 Text 0 0 ,First,#,{0},LECHE,-1,-1;NCONTR "NCONTR" true true false 1 Short 0 1 ,First,#,{0},NCONTR,-1,-1;CONTRATO "CONTRATO" true true false 15 Text 0 0 ,First,#,{0},CONTRATO,-1,-1;NLOCA "NLOCA" true true false 2 Short 0 2 ,First,#,{0},NLOCA,-1,-1;LOCAL "LOCAL" true true false 20 Text 0 0 ,First,#,{0},LOCAL,-1,-1;TURNO "TURNO" true true false 10 Text 0 0 ,First,#,{0},TURNO,-1,-1;TMATINI "TMATINI" true true false 5 Text 0 0 ,First,#,{0},TMATINI,-1,-1;TMATFIN "TMATFIN" true true false 5 Text 0 0 ,First,#,{0},TMATFIN,-1,-1;TVESINI "TVESINI" true true false 5 Text 0 0 ,First,#,{0},TVESINI,-1,-1;TVESFIN "TVESFIN" true true false 5 Text 0 0 ,First,#,{0},TVESFIN,-1,-1;LITROS "LITROS" true true false 6 Long 0 6 ,First,#,{0},LITROS,-1,-1;ML_TLECH "ML_TLECH" true true false 1 Short 0 1 ,First,#,{0},ML_TLECH,-1,-1;TIPO "TIPO" true true false 10 Text 0 0 ,First,#,{0},TIPO,-1,-1;HABITANTES "HABITANTES" true true false 9 Long 0 9 ,First,#,{0},HABITANTES,-1,-1;MUJERES "MUJERES" true true false 11 Double 0 11 ,First,#,{0},MUJERES,-1,-1;HOMBRES "HOMBRES" true true false 7 Long 0 7 ,First,#,{0},HOMBRES,-1,-1;AGEB "AGEB" true true false 5 Text 0 0 ,First,#,{0},AGEB,-1,-1;CPOSTAL "CPOSTAL" true true false 5 Long 0 5 ,First,#,{0},CPOSTAL,-1,-1;PROMOTOR "PROMOTOR" true true false 40 Text 0 0 ,First,#,{0},PROMOTOR,-1,-1;SUPERVISO "SUPERVISO" true true false 40 Text 0 0 ,First,#,{0},SUPERVISO,-1,-1;CONCESIO "CONCESIO" true true false 40 Text 0 0 ,First,#,{0},CONCESIO,-1,-1;DNRUTA "DNRUTA" true true false 6 Text 0 0 ,First,#,{0},DNRUTA,-1,-1;DSECUENCIA "DSECUENCIA" true true false 2 Short 0 2 ,First,#,{0},DSECUENCIA,-1,-1;DKMS "DKMS" true true false 19 Double 2 18 ,First,#,{0},DKMS,-1,-1;DTIEMPO "DTIEMPO" true true false 5 Long 0 5 ,First,#,{0},DTIEMPO,-1,-1;DSUBSIDIA "DSUBSIDIA" true true false 7 Long 0 7 ,First,#,{0},DSUBSIDIA,-1,-1;DFRISIA "DFRISIA" true true false 7 Long 0 7 ,First,#,{0},DFRISIA,-1,-1;DINSTITU "DINSTITU" true true false 7 Long 0 7 ,First,#,{0},DINSTITU,-1,-1;DSEMIDES "DSEMIDES" true true false 7 Long 0 7 ,First,#,{0},DSEMIDES,-1,-1;DFRESA "DFRESA" true true false 7 Long 0 7 ,First,#,{0},DFRESA,-1,-1;DVAINILLA "DVAINILLA" true true false 7 Long 0 7 ,First,#,{0},DVAINILLA,-1,-1;DCHOCOLATE "DCHOCOLATE" true true false 7 Long 0 7 ,First,#,{0},DCHOCOLATE,-1,-1;LTSBENMES "LTSBENMES" true true false 19 Double 2 18 ,First,#,{0},LTSBENMES,-1,-1'.format(self.lyer.name))
		TableToTable_conversion(self.lyer,u'CARTO2010','t_lecheria2010_133_final_{0}.dbf'.format(self.fch.strftime('%b%y')),None,flm)

	def productos_c(self):
		flm = FieldMappings()
		flm.loadFromString(u'CVE_LECHE "CVE_LECHE" true true false 10 Text 0 0 ,First,#,{0},CVE_LECHE,-1,-1;CVE_ENT "CVE_ENT" true true false 2 Text 0 0 ,First,#,{0},CVE_ENT,-1,-1;CVE_MUNC "CVE_MUNC" true true false 5 Text 0 0 ,First,#,{0},CVE_MUNC,-1,-1;CVE_LOCC "CVE_LOCC" true true false 9 Text 0 0 ,First,#,{0},CVE_LOCC,-1,-1;NOM_ENT "NOM_ENT" true true false 110 Text 0 0 ,First,#,{0},NOM_ENT,-1,-1;ABRE_ENT "ABRE_ENT" true true false 16 Text 0 0 ,First,#,{0},ABRE_ENT,-1,-1;NOM_MUN "NOM_MUN" true true false 110 Text 0 0 ,First,#,{0},NOM_MUN,-1,-1;NOM_LOC "NOM_LOC" true true false 110 Text 0 0 ,First,#,{0},NOM_LOC,-1,-1;LOCURB "LOCURB" true true false 2 Text 0 0 ,First,#,{0},LOCURB,-1,-1;PAS "PAS" true true false 30 Text 0 0 ,First,#,{0},PAS,-1,-1;CALLE "CALLE" true true false 40 Text 0 0 ,First,#,{0},CALLE,-1,-1;COLONIA "COLONIA" true true false 40 Text 0 0 ,First,#,{0},COLONIA,-1,-1;REFNCIA "REFNCIA" true true false 60 Text 0 0 ,First,#,{0},REFNCIA,-1,-1;FAMILIAS "FAMILIAS" true true false 5 Long 0 5 ,First,#,{0},FAMILIAS,-1,-1;BENEFICIAR "BENEFICIAR" true true false 6 Long 0 6 ,First,#,{0},BENEFICIAR,-1,-1;NIN0A12 "NIN0A12" true true false 6 Long 0 6 ,First,#,{0},NIN0A12,-1,-1;GESTLAC "GESTLAC" true true false 6 Long 0 6 ,First,#,{0},GESTLAC,-1,-1;ENFCRODIS "ENFCRODIS" true true false 6 Long 0 6 ,First,#,{0},ENFCRODIS,-1,-1;ADUL60_ "ADUL60_" true true false 6 Long 0 6 ,First,#,{0},ADUL60_,-1,-1;MUJ13A15 "MUJ13A15" true true false 5 Long 0 5 ,First,#,{0},MUJ13A15,-1,-1;MUJ45A59 "MUJ45A59" true true false 5 Long 0 5 ,First,#,{0},MUJ45A59,-1,-1;ML_TVENTA "ML_TVENTA" true true false 1 Short 0 1 ,First,#,{0},ML_TVENTA,-1,-1;INIOPER "INIOPER" true true false 8 Date 0 0 ,First,#,{0},INIOPER,-1,-1;LECHE "LECHE" true true false 7 Text 0 0 ,First,#,{0},LECHE,-1,-1;NCONTR "NCONTR" true true false 1 Short 0 1 ,First,#,{0},NCONTR,-1,-1;CONTRATO "CONTRATO" true true false 15 Text 0 0 ,First,#,{0},CONTRATO,-1,-1;NLOCA "NLOCA" true true false 2 Short 0 2 ,First,#,{0},NLOCA,-1,-1;LOCAL "LOCAL" true true false 20 Text 0 0 ,First,#,{0},LOCAL,-1,-1;TURNO "TURNO" true true false 10 Text 0 0 ,First,#,{0},TURNO,-1,-1;TMATINI "TMATINI" true true false 5 Text 0 0 ,First,#,{0},TMATINI,-1,-1;TMATFIN "TMATFIN" true true false 5 Text 0 0 ,First,#,{0},TMATFIN,-1,-1;TVESINI "TVESINI" true true false 5 Text 0 0 ,First,#,{0},TVESINI,-1,-1;TVESFIN "TVESFIN" true true false 5 Text 0 0 ,First,#,{0},TVESFIN,-1,-1;ML_TLECH "ML_TLECH" true true false 1 Short 0 1 ,First,#,{0},ML_TLECH,-1,-1;TIPO "TIPO" true true false 10 Text 0 0 ,First,#,{0},TIPO,-1,-1;HABITANTES "HABITANTES" true true false 9 Long 0 9 ,First,#,{0},HABITANTES,-1,-1;MUJERES "MUJERES" true true false 11 Double 0 11 ,First,#,{0},MUJERES,-1,-1;HOMBRES "HOMBRES" true true false 7 Long 0 7 ,First,#,{0},HOMBRES,-1,-1;AGEB "AGEB" true true false 5 Text 0 0 ,First,#,{0},AGEB,-1,-1;CPOSTAL "CPOSTAL" true true false 5 Long 0 5 ,First,#,{0},CPOSTAL,-1,-1'.format(self.lyer.name))
		Merge_management(self.lyer,join(u'PRODUCTOS_COMITE','{0}_LECHERIAS_{1}.shp'.format(self.fch.strftime('%Y%m'),self.fch.strftime('%m%Y'))),flm)

	def sin_cc(self):
		mkd(u'SIN_CAMPOS_CONFIDENCIALES')
		flm = FieldMappings()
		flm.loadFromString(u'CVE_LECHE "CVE_LECHE" true true false 10 Text 0 0 ,First,#,{0},CVE_LECHE,-1,-1;CVE_ENT "CVE_ENT" true true false 2 Text 0 0 ,First,#,{0},CVE_ENT,-1,-1;CVE_MUNC "CVE_MUNC" true true false 5 Text 0 0 ,First,#,{0},CVE_MUNC,-1,-1;CVE_LOCC "CVE_LOCC" true true false 9 Text 0 0 ,First,#,{0},CVE_LOCC,-1,-1;NOM_ENT "NOM_ENT" true true false 110 Text 0 0 ,First,#,{0},NOM_ENT,-1,-1;ABRE_ENT "ABRE_ENT" true true false 16 Text 0 0 ,First,#,{0},ABRE_ENT,-1,-1;NOM_MUN "NOM_MUN" true true false 110 Text 0 0 ,First,#,{0},NOM_MUN,-1,-1;NOM_LOC "NOM_LOC" true true false 110 Text 0 0 ,First,#,{0},NOM_LOC,-1,-1;LOCURB "LOCURB" true true false 2 Text 0 0 ,First,#,{0},LOCURB,-1,-1;PAS "PAS" true true false 30 Text 0 0 ,First,#,{0},PAS,-1,-1;CALLE "CALLE" true true false 40 Text 0 0 ,First,#,{0},CALLE,-1,-1;COLONIA "COLONIA" true true false 40 Text 0 0 ,First,#,{0},COLONIA,-1,-1;REFNCIA "REFNCIA" true true false 60 Text 0 0 ,First,#,{0},REFNCIA,-1,-1;FAMILIAS "FAMILIAS" true true false 5 Long 0 5 ,First,#,{0},FAMILIAS,-1,-1;BENEFICIAR "BENEFICIAR" true true false 6 Long 0 6 ,First,#,{0},BENEFICIAR,-1,-1;NIN0A12 "NIN0A12" true true false 6 Long 0 6 ,First,#,{0},NIN0A12,-1,-1;GESTLAC "GESTLAC" true true false 6 Long 0 6 ,First,#,{0},GESTLAC,-1,-1;ENFCRODIS "ENFCRODIS" true true false 6 Long 0 6 ,First,#,{0},ENFCRODIS,-1,-1;ADUL60_ "ADUL60_" true true false 6 Long 0 6 ,First,#,{0},ADUL60_,-1,-1;MUJ13A15 "MUJ13A15" true true false 5 Long 0 5 ,First,#,{0},MUJ13A15,-1,-1;MUJ45A59 "MUJ45A59" true true false 5 Long 0 5 ,First,#,{0},MUJ45A59,-1,-1;ML_TVENTA "ML_TVENTA" true true false 1 Short 0 1 ,First,#,{0},ML_TVENTA,-1,-1;INIOPER "INIOPER" true true false 8 Date 0 0 ,First,#,{0},INIOPER,-1,-1;LECHE "LECHE" true true false 7 Text 0 0 ,First,#,{0},LECHE,-1,-1;NCONTR "NCONTR" true true false 1 Short 0 1 ,First,#,{0},NCONTR,-1,-1;CONTRATO "CONTRATO" true true false 15 Text 0 0 ,First,#,{0},CONTRATO,-1,-1;NLOCA "NLOCA" true true false 2 Short 0 2 ,First,#,{0},NLOCA,-1,-1;LOCAL "LOCAL" true true false 20 Text 0 0 ,First,#,{0},LOCAL,-1,-1;TURNO "TURNO" true true false 10 Text 0 0 ,First,#,{0},TURNO,-1,-1;TMATINI "TMATINI" true true false 5 Text 0 0 ,First,#,{0},TMATINI,-1,-1;TMATFIN "TMATFIN" true true false 5 Text 0 0 ,First,#,{0},TMATFIN,-1,-1;TVESINI "TVESINI" true true false 5 Text 0 0 ,First,#,{0},TVESINI,-1,-1;TVESFIN "TVESFIN" true true false 5 Text 0 0 ,First,#,{0},TVESFIN,-1,-1;ML_TLECH "ML_TLECH" true true false 1 Short 0 1 ,First,#,{0},ML_TLECH,-1,-1;TIPO "TIPO" true true false 10 Text 0 0 ,First,#,{0},TIPO,-1,-1;HABITANTES "HABITANTES" true true false 9 Long 0 9 ,First,#,{0},HABITANTES,-1,-1;MUJERES "MUJERES" true true false 11 Double 0 11 ,First,#,{0},MUJERES,-1,-1;HOMBRES "HOMBRES" true true false 7 Long 0 7 ,First,#,{0},HOMBRES,-1,-1;AGEB "AGEB" true true false 5 Text 0 0 ,First,#,{0},AGEB,-1,-1;CPOSTAL "CPOSTAL" true true false 5 Long 0 5 ,First,#,{0},CPOSTAL,-1,-1'.format(self.lyer.name))
		Merge_management(self.lyer,join(u'SIN_CAMPOS_CONFIDENCIALES','lecheriasnacional{0}.shp'.format(self.fch.strftime('%m%y'))),flm)
		RemoveLayer(self.mxd.activeDataFrame,Layer(self.lyer.name))
		AddLayer(self.mxd.activeDataFrame,Layer(join(u'SIN_CAMPOS_CONFIDENCIALES','lecheriasnacional{0}.shp'.format(self.fch.strftime('%m%y')))))